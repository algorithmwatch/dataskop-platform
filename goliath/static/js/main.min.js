function addUserToJson(e){var n=e.pages.length-1,t=e.pages[n].elements[0],i={visible:!1,type:"text",name:"awfirstnamequestion",title:"Wie ist dein Vorname?",visibleIf:t.visibleIf};return t.visibleIf="{awemailquestion} notempty",e.pages[n].elements=[i,{visible:!1,type:"text",name:"awlastnamequestion",title:"Wie ist dein Nachname?",visibleIf:"{awfirstnamequestion} notempty"},{visible:!1,type:"text",name:"awemailquestion",title:"Wie ist dein E-Mail-Adresse?",visibleIf:"{awlastnamequestion} notempty",validators:[{type:"email"}]},t],e}function setupSurvey(e,n,t,i){i&&(n=addUserToJson(n)),window.isCompleting=!1;var o=new Survey.Model(n);o.locale="de",o.showPreviewBeforeComplete=!0,o.completedHtml="<p>Bitte einen kurzen Augenblick warten...</p>",o.questionsOnPageMode="singlePage",o.clearInvisibleValues="onHidden",o.completeText="Anliegen melden & versenden",window.awsurvey=o,$(".survey-inner").Survey({model:window.awsurvey,onAfterRenderQuestion:function(e,n){"previewhtml"===n.question.name&&$(".aw-completebutton").removeClass("invisible"),setTimeout(function(){n.htmlElement.scrollIntoView({behavior:"smooth",block:"end",inline:"end"})},100),setTimeout(function(){$(n.htmlElement).find("input").focus(),n.htmlElement.focus()},150)},onComplete:function n(i,o){if(o.isCompleteOnTrigger)return alert("Please do something else"),void window.location.replace("/neu/");var l={answers:JSON.stringify(i.data),text:window.finalText,csrfmiddlewaretoken:t};$.post("/neu/"+e+"/",l).done(function(e){window.location.replace(e.url)}).fail(function(){alert("error"),setTimeout(function(){n(i,o)},1e3)})},onCompleting:function(){return window.isCompleting=!0,!0},onValueChanged:function(e,n){"previewhtml"!=n.name&&!1===window.isCompleting&&(window.finalText=function(){for(var e="",n=window.awsurvey.getPlainData(),t=0;t<n.length;t++)null!=n[t].value&&(e+=n[t].value+" ");return e}(),window.awsurvey.getQuestionByName("previewhtml").html="<div class='previewhtml'><h2>Vorschau</h2><p>"+window.finalText+"</p></div>");var t=document.getElementById(n.name);t&&(t.value=n.value)},css:{navigation:{complete:"btn invisible aw-completebutton"},question:{mainRoot:"sv_q sv_qstn"}}})}window.setupSurvey=setupSurvey;